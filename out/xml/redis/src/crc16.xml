<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" revision="1.0.0" language="C" filename="/cloned_projects/redis/src/crc16.c"><cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"server.h"</cpp:file></cpp:include>

<comment type="block">/*
 * Copyright 2001-2010 Georges Menie (www.menie.org)
 * Copyright 2010-2012 Salvatore Sanfilippo (adapted to Redis coding style)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of the University of California, Berkeley nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */</comment>

<comment type="block">/* CRC16 implementation according to CCITT standards.
 *
 * Note by @antirez: this is actually the XMODEM CRC 16 algorithm, using the
 * following parameters:
 *
 * Name                       : "XMODEM", also known as "ZMODEM", "CRC-16/ACORN"
 * Width                      : 16 bit
 * Poly                       : 1021 (That is actually x^16 + x^12 + x^5 + 1)
 * Initialization             : 0000
 * Reflect Input byte         : False
 * Reflect Output CRC         : False
 * Xor constant to output CRC : 0000
 * Output for "123456789"     : 31C3
 */</comment>

<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>uint16_t</name></type> <name><name>crc16tab</name><index>[<expr><literal type="number">256</literal></expr>]</index></name><init>= <expr><block>{
    <expr><literal type="number">0x0000</literal></expr>,<expr><literal type="number">0x1021</literal></expr>,<expr><literal type="number">0x2042</literal></expr>,<expr><literal type="number">0x3063</literal></expr>,<expr><literal type="number">0x4084</literal></expr>,<expr><literal type="number">0x50a5</literal></expr>,<expr><literal type="number">0x60c6</literal></expr>,<expr><literal type="number">0x70e7</literal></expr>,
    <expr><literal type="number">0x8108</literal></expr>,<expr><literal type="number">0x9129</literal></expr>,<expr><literal type="number">0xa14a</literal></expr>,<expr><literal type="number">0xb16b</literal></expr>,<expr><literal type="number">0xc18c</literal></expr>,<expr><literal type="number">0xd1ad</literal></expr>,<expr><literal type="number">0xe1ce</literal></expr>,<expr><literal type="number">0xf1ef</literal></expr>,
    <expr><literal type="number">0x1231</literal></expr>,<expr><literal type="number">0x0210</literal></expr>,<expr><literal type="number">0x3273</literal></expr>,<expr><literal type="number">0x2252</literal></expr>,<expr><literal type="number">0x52b5</literal></expr>,<expr><literal type="number">0x4294</literal></expr>,<expr><literal type="number">0x72f7</literal></expr>,<expr><literal type="number">0x62d6</literal></expr>,
    <expr><literal type="number">0x9339</literal></expr>,<expr><literal type="number">0x8318</literal></expr>,<expr><literal type="number">0xb37b</literal></expr>,<expr><literal type="number">0xa35a</literal></expr>,<expr><literal type="number">0xd3bd</literal></expr>,<expr><literal type="number">0xc39c</literal></expr>,<expr><literal type="number">0xf3ff</literal></expr>,<expr><literal type="number">0xe3de</literal></expr>,
    <expr><literal type="number">0x2462</literal></expr>,<expr><literal type="number">0x3443</literal></expr>,<expr><literal type="number">0x0420</literal></expr>,<expr><literal type="number">0x1401</literal></expr>,<expr><literal type="number">0x64e6</literal></expr>,<expr><literal type="number">0x74c7</literal></expr>,<expr><literal type="number">0x44a4</literal></expr>,<expr><literal type="number">0x5485</literal></expr>,
    <expr><literal type="number">0xa56a</literal></expr>,<expr><literal type="number">0xb54b</literal></expr>,<expr><literal type="number">0x8528</literal></expr>,<expr><literal type="number">0x9509</literal></expr>,<expr><literal type="number">0xe5ee</literal></expr>,<expr><literal type="number">0xf5cf</literal></expr>,<expr><literal type="number">0xc5ac</literal></expr>,<expr><literal type="number">0xd58d</literal></expr>,
    <expr><literal type="number">0x3653</literal></expr>,<expr><literal type="number">0x2672</literal></expr>,<expr><literal type="number">0x1611</literal></expr>,<expr><literal type="number">0x0630</literal></expr>,<expr><literal type="number">0x76d7</literal></expr>,<expr><literal type="number">0x66f6</literal></expr>,<expr><literal type="number">0x5695</literal></expr>,<expr><literal type="number">0x46b4</literal></expr>,
    <expr><literal type="number">0xb75b</literal></expr>,<expr><literal type="number">0xa77a</literal></expr>,<expr><literal type="number">0x9719</literal></expr>,<expr><literal type="number">0x8738</literal></expr>,<expr><literal type="number">0xf7df</literal></expr>,<expr><literal type="number">0xe7fe</literal></expr>,<expr><literal type="number">0xd79d</literal></expr>,<expr><literal type="number">0xc7bc</literal></expr>,
    <expr><literal type="number">0x48c4</literal></expr>,<expr><literal type="number">0x58e5</literal></expr>,<expr><literal type="number">0x6886</literal></expr>,<expr><literal type="number">0x78a7</literal></expr>,<expr><literal type="number">0x0840</literal></expr>,<expr><literal type="number">0x1861</literal></expr>,<expr><literal type="number">0x2802</literal></expr>,<expr><literal type="number">0x3823</literal></expr>,
    <expr><literal type="number">0xc9cc</literal></expr>,<expr><literal type="number">0xd9ed</literal></expr>,<expr><literal type="number">0xe98e</literal></expr>,<expr><literal type="number">0xf9af</literal></expr>,<expr><literal type="number">0x8948</literal></expr>,<expr><literal type="number">0x9969</literal></expr>,<expr><literal type="number">0xa90a</literal></expr>,<expr><literal type="number">0xb92b</literal></expr>,
    <expr><literal type="number">0x5af5</literal></expr>,<expr><literal type="number">0x4ad4</literal></expr>,<expr><literal type="number">0x7ab7</literal></expr>,<expr><literal type="number">0x6a96</literal></expr>,<expr><literal type="number">0x1a71</literal></expr>,<expr><literal type="number">0x0a50</literal></expr>,<expr><literal type="number">0x3a33</literal></expr>,<expr><literal type="number">0x2a12</literal></expr>,
    <expr><literal type="number">0xdbfd</literal></expr>,<expr><literal type="number">0xcbdc</literal></expr>,<expr><literal type="number">0xfbbf</literal></expr>,<expr><literal type="number">0xeb9e</literal></expr>,<expr><literal type="number">0x9b79</literal></expr>,<expr><literal type="number">0x8b58</literal></expr>,<expr><literal type="number">0xbb3b</literal></expr>,<expr><literal type="number">0xab1a</literal></expr>,
    <expr><literal type="number">0x6ca6</literal></expr>,<expr><literal type="number">0x7c87</literal></expr>,<expr><literal type="number">0x4ce4</literal></expr>,<expr><literal type="number">0x5cc5</literal></expr>,<expr><literal type="number">0x2c22</literal></expr>,<expr><literal type="number">0x3c03</literal></expr>,<expr><literal type="number">0x0c60</literal></expr>,<expr><literal type="number">0x1c41</literal></expr>,
    <expr><literal type="number">0xedae</literal></expr>,<expr><literal type="number">0xfd8f</literal></expr>,<expr><literal type="number">0xcdec</literal></expr>,<expr><literal type="number">0xddcd</literal></expr>,<expr><literal type="number">0xad2a</literal></expr>,<expr><literal type="number">0xbd0b</literal></expr>,<expr><literal type="number">0x8d68</literal></expr>,<expr><literal type="number">0x9d49</literal></expr>,
    <expr><literal type="number">0x7e97</literal></expr>,<expr><literal type="number">0x6eb6</literal></expr>,<expr><literal type="number">0x5ed5</literal></expr>,<expr><literal type="number">0x4ef4</literal></expr>,<expr><literal type="number">0x3e13</literal></expr>,<expr><literal type="number">0x2e32</literal></expr>,<expr><literal type="number">0x1e51</literal></expr>,<expr><literal type="number">0x0e70</literal></expr>,
    <expr><literal type="number">0xff9f</literal></expr>,<expr><literal type="number">0xefbe</literal></expr>,<expr><literal type="number">0xdfdd</literal></expr>,<expr><literal type="number">0xcffc</literal></expr>,<expr><literal type="number">0xbf1b</literal></expr>,<expr><literal type="number">0xaf3a</literal></expr>,<expr><literal type="number">0x9f59</literal></expr>,<expr><literal type="number">0x8f78</literal></expr>,
    <expr><literal type="number">0x9188</literal></expr>,<expr><literal type="number">0x81a9</literal></expr>,<expr><literal type="number">0xb1ca</literal></expr>,<expr><literal type="number">0xa1eb</literal></expr>,<expr><literal type="number">0xd10c</literal></expr>,<expr><literal type="number">0xc12d</literal></expr>,<expr><literal type="number">0xf14e</literal></expr>,<expr><literal type="number">0xe16f</literal></expr>,
    <expr><literal type="number">0x1080</literal></expr>,<expr><literal type="number">0x00a1</literal></expr>,<expr><literal type="number">0x30c2</literal></expr>,<expr><literal type="number">0x20e3</literal></expr>,<expr><literal type="number">0x5004</literal></expr>,<expr><literal type="number">0x4025</literal></expr>,<expr><literal type="number">0x7046</literal></expr>,<expr><literal type="number">0x6067</literal></expr>,
    <expr><literal type="number">0x83b9</literal></expr>,<expr><literal type="number">0x9398</literal></expr>,<expr><literal type="number">0xa3fb</literal></expr>,<expr><literal type="number">0xb3da</literal></expr>,<expr><literal type="number">0xc33d</literal></expr>,<expr><literal type="number">0xd31c</literal></expr>,<expr><literal type="number">0xe37f</literal></expr>,<expr><literal type="number">0xf35e</literal></expr>,
    <expr><literal type="number">0x02b1</literal></expr>,<expr><literal type="number">0x1290</literal></expr>,<expr><literal type="number">0x22f3</literal></expr>,<expr><literal type="number">0x32d2</literal></expr>,<expr><literal type="number">0x4235</literal></expr>,<expr><literal type="number">0x5214</literal></expr>,<expr><literal type="number">0x6277</literal></expr>,<expr><literal type="number">0x7256</literal></expr>,
    <expr><literal type="number">0xb5ea</literal></expr>,<expr><literal type="number">0xa5cb</literal></expr>,<expr><literal type="number">0x95a8</literal></expr>,<expr><literal type="number">0x8589</literal></expr>,<expr><literal type="number">0xf56e</literal></expr>,<expr><literal type="number">0xe54f</literal></expr>,<expr><literal type="number">0xd52c</literal></expr>,<expr><literal type="number">0xc50d</literal></expr>,
    <expr><literal type="number">0x34e2</literal></expr>,<expr><literal type="number">0x24c3</literal></expr>,<expr><literal type="number">0x14a0</literal></expr>,<expr><literal type="number">0x0481</literal></expr>,<expr><literal type="number">0x7466</literal></expr>,<expr><literal type="number">0x6447</literal></expr>,<expr><literal type="number">0x5424</literal></expr>,<expr><literal type="number">0x4405</literal></expr>,
    <expr><literal type="number">0xa7db</literal></expr>,<expr><literal type="number">0xb7fa</literal></expr>,<expr><literal type="number">0x8799</literal></expr>,<expr><literal type="number">0x97b8</literal></expr>,<expr><literal type="number">0xe75f</literal></expr>,<expr><literal type="number">0xf77e</literal></expr>,<expr><literal type="number">0xc71d</literal></expr>,<expr><literal type="number">0xd73c</literal></expr>,
    <expr><literal type="number">0x26d3</literal></expr>,<expr><literal type="number">0x36f2</literal></expr>,<expr><literal type="number">0x0691</literal></expr>,<expr><literal type="number">0x16b0</literal></expr>,<expr><literal type="number">0x6657</literal></expr>,<expr><literal type="number">0x7676</literal></expr>,<expr><literal type="number">0x4615</literal></expr>,<expr><literal type="number">0x5634</literal></expr>,
    <expr><literal type="number">0xd94c</literal></expr>,<expr><literal type="number">0xc96d</literal></expr>,<expr><literal type="number">0xf90e</literal></expr>,<expr><literal type="number">0xe92f</literal></expr>,<expr><literal type="number">0x99c8</literal></expr>,<expr><literal type="number">0x89e9</literal></expr>,<expr><literal type="number">0xb98a</literal></expr>,<expr><literal type="number">0xa9ab</literal></expr>,
    <expr><literal type="number">0x5844</literal></expr>,<expr><literal type="number">0x4865</literal></expr>,<expr><literal type="number">0x7806</literal></expr>,<expr><literal type="number">0x6827</literal></expr>,<expr><literal type="number">0x18c0</literal></expr>,<expr><literal type="number">0x08e1</literal></expr>,<expr><literal type="number">0x3882</literal></expr>,<expr><literal type="number">0x28a3</literal></expr>,
    <expr><literal type="number">0xcb7d</literal></expr>,<expr><literal type="number">0xdb5c</literal></expr>,<expr><literal type="number">0xeb3f</literal></expr>,<expr><literal type="number">0xfb1e</literal></expr>,<expr><literal type="number">0x8bf9</literal></expr>,<expr><literal type="number">0x9bd8</literal></expr>,<expr><literal type="number">0xabbb</literal></expr>,<expr><literal type="number">0xbb9a</literal></expr>,
    <expr><literal type="number">0x4a75</literal></expr>,<expr><literal type="number">0x5a54</literal></expr>,<expr><literal type="number">0x6a37</literal></expr>,<expr><literal type="number">0x7a16</literal></expr>,<expr><literal type="number">0x0af1</literal></expr>,<expr><literal type="number">0x1ad0</literal></expr>,<expr><literal type="number">0x2ab3</literal></expr>,<expr><literal type="number">0x3a92</literal></expr>,
    <expr><literal type="number">0xfd2e</literal></expr>,<expr><literal type="number">0xed0f</literal></expr>,<expr><literal type="number">0xdd6c</literal></expr>,<expr><literal type="number">0xcd4d</literal></expr>,<expr><literal type="number">0xbdaa</literal></expr>,<expr><literal type="number">0xad8b</literal></expr>,<expr><literal type="number">0x9de8</literal></expr>,<expr><literal type="number">0x8dc9</literal></expr>,
    <expr><literal type="number">0x7c26</literal></expr>,<expr><literal type="number">0x6c07</literal></expr>,<expr><literal type="number">0x5c64</literal></expr>,<expr><literal type="number">0x4c45</literal></expr>,<expr><literal type="number">0x3ca2</literal></expr>,<expr><literal type="number">0x2c83</literal></expr>,<expr><literal type="number">0x1ce0</literal></expr>,<expr><literal type="number">0x0cc1</literal></expr>,
    <expr><literal type="number">0xef1f</literal></expr>,<expr><literal type="number">0xff3e</literal></expr>,<expr><literal type="number">0xcf5d</literal></expr>,<expr><literal type="number">0xdf7c</literal></expr>,<expr><literal type="number">0xaf9b</literal></expr>,<expr><literal type="number">0xbfba</literal></expr>,<expr><literal type="number">0x8fd9</literal></expr>,<expr><literal type="number">0x9ff8</literal></expr>,
    <expr><literal type="number">0x6e17</literal></expr>,<expr><literal type="number">0x7e36</literal></expr>,<expr><literal type="number">0x4e55</literal></expr>,<expr><literal type="number">0x5e74</literal></expr>,<expr><literal type="number">0x2e93</literal></expr>,<expr><literal type="number">0x3eb2</literal></expr>,<expr><literal type="number">0x0ed1</literal></expr>,<expr><literal type="number">0x1ef0</literal></expr>
}</block></expr></init></decl>;</decl_stmt>

<function><type><name>uint16_t</name></type> <name>crc16</name><parameter_list>(<parameter><decl><type><specifier>const</specifier> <name>char</name> <modifier>*</modifier></type><name>buf</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>len</name></decl></parameter>)</parameter_list> <block>{<block_content>
    <decl_stmt><decl><type><name>int</name></type> <name>counter</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>uint16_t</name></type> <name>crc</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
    <for>for <control>(<init><expr><name>counter</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>counter</name> <operator>&lt;</operator> <name>len</name></expr>;</condition> <incr><expr><name>counter</name><operator>++</operator></expr></incr>)</control><block type="pseudo"><block_content>
            <expr_stmt><expr><name>crc</name> <operator>=</operator> <operator>(</operator><name>crc</name><operator>&lt;&lt;</operator><literal type="number">8</literal><operator>)</operator> <operator>^</operator> <name><name>crc16tab</name><index>[<expr><operator>(</operator><operator>(</operator><name>crc</name><operator>&gt;&gt;</operator><literal type="number">8</literal><operator>)</operator> <operator>^</operator> <operator>*</operator><name>buf</name><operator>++</operator><operator>)</operator><operator>&amp;</operator><literal type="number">0x00FF</literal></expr>]</index></name></expr>;</expr_stmt></block_content></block></for>
    <return>return <expr><name>crc</name></expr>;</return>
</block_content>}</block></function>
</unit>
